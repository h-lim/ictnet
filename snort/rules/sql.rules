----- Begin VRT-server-mssql Rules Category ----- 

 -- Begin GID:1 Based Rules -- 

 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433:1500 (msg:"SERVER-MSSQL Microsoft SQL Server 2000 Server hello buffer overflow attempt"; flow:to_server,established; isdataat:514; content:"|12 01|"; depth:2; content:!"|00|"; within:512; distance:35; reference:bugtraq,5411; reference:cve,2002-1123; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-056; classtype:attempted-admin; sid:11264; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL raiserror possible buffer overflow"; flow:to_server,established; content:"r|00|a|00|i|00|s|00|e|00|r|00|r|00|o|00|r|00|"; offset:32; nocase; metadata:ruleset community; reference:bugtraq,3733; reference:cve,2001-0542; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-060; classtype:attempted-user; sid:1386; rev:15;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL Memory page overwrite attempt "; flow:to_server,established; content:"insert"; nocase; content:"null"; distance:1; nocase; content:"select"; distance:1; nocase; pcre:"/insert\s+into\s+(\w+)\s+values\s*\(\s*null\s*\).*select\s+isnull\s*\(\s*\w+\s*,\s*(\x27\x27|\x22\x22)\s*\)\s*from\s+\1/smi"; reference:cve,2008-0106; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13891; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL Convert function style overwrite "; flow:to_server, established; content:"Convert"; nocase; pcre:"/select\s+convert\s*\(\w+(\(\d+\))?\s*,\s*((\w+|\w+\(.*\)|\w+\.\w+|\([^\)]*\))|(\w+|\w+\(.*\)|\w+\.\w+|\([^\)]*\))\s*(ALL|AND|ANY|BETWEEN|EXISTS|IN|LIKE|NOT|OR|SOME|=|\+|>|<|\/|%|\*|-||&|\||\^|~|>=|<>|<=|\!=|\!<|\!>)\s*(\w+|\w+\(.*\)|\w+\.\w+|\([^\)]*\)))\s*,\s*\d{5,}\s*\)/smi"; reference:cve,2008-0086; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13892; rev:8;)
 alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-MSSQL Microsoft SQL server MTF file download"; flow:to_client,established; file_data; content:"TAPE"; content:"|00 12|"; within:2; distance:82; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-0085; reference:cve,2008-0107; reference:url,blogs.technet.com/swi/archive/2008/07/08/ms08-040-how-to-spot-potentially-dangerous-mtf-files-crossing-network-boundary.aspx; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-040; classtype:misc-activity; sid:13896; rev:14;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS [445,1433] (msg:"SERVER-MSSQL sp_replwritetovarbin unicode vulnerable function attempt"; flow:to_server,established; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15143; rev:15;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS [445,1433] (msg:"SERVER-MSSQL sp_replwritetovarbin vulnerable function attempt"; flow:to_server,established; content:"sp_replwritetovarbin"; fast_pattern:only; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15144; rev:11;)
 alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SERVER-MSSQL Microsoft SQL Server Distributed Management Objects overflow attempt"; flow:to_client,established; file_data; content:"<object classid='clsid|3A|10020200-E260-11CF-AE68-00AA004A34D5' id='SQLServer'"; nocase; content:"SQLDMO.SQLServer"; nocase; pcre:"/progid\s*\x3d\s*[\x22\x27]SQLDMO\x2eSQLServer[\x22\x27]/"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,25594; reference:cve,2007-4814; classtype:attempted-user; sid:16208; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL Microsoft SQL Server INSERT Statement Buffer Overflow attempt"; flow:to_server, established; content:"i|00|n|00|s|00|e|00|r|00|t|00 20 00|i|00|n|00|t|00|o|00 20 00|m|00|y|00|t|00|a|00|b|00|l|00|e|00 20 00|v|00|a|00|l|00|u|00|e|00|s|00 20 00 28 00|n|00|u|00|l|00|l|00 29|"; metadata:policy max-detect-ips drop; reference:cve,2008-0106; classtype:policy-violation; sid:17307; rev:7;)
 alert udp $EXTERNAL_NET any -> $HOME_NET 1434 (msg:"SERVER-MSSQL version overflow attempt"; flow:to_server; dsize:>100; content:"|04|"; depth:1; metadata:ruleset community; reference:bugtraq,5310; reference:cve,2002-0649; reference:nessus,10674; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-039; classtype:attempted-admin; sid:2050; rev:18;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1024:5000 (msg:"SERVER-MSSQL MSSQL CONVERT function buffer overflow attempt"; flow:to_server,established; content:"|01|"; depth:1; content:"CONVERT"; distance:0; nocase; pcre:"/CONVERT[^\x28]*\x28[^\x2c]*\x2c([^\x2c]*\x2c)?[^\d]*\d{6,}/i"; reference:cve,2008-0086; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:21084; rev:2;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1024:5000 (msg:"SERVER-MSSQL MSSQL CONVERT function unicode buffer overflow attempt"; flow:to_server,established; content:"|01|"; depth:1; content:"C|00|O|00|N|00|V|00|E|00|R|00|T|00|"; distance:0; nocase; pcre:"/C\x00O\x00N\x00V\x00E\x00R\x00T[^\x28]*\x28[^\x2c]*\x2c([^\x2c]*\x2c)?[^\d]*\d\x00\d\x00\d\x00\d\x00\d\x00\d/i"; reference:cve,2008-0086; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:21085; rev:2;)
 alert udp $EXTERNAL_NET any -> $SQL_SERVERS any (msg:"SERVER-MSSQL probe response overflow attempt"; flow:to_server; content:"|05|"; depth:1; byte_test:2,>,512,1; content:"|3B|"; distance:0; isdataat:512,relative; content:!"|3B|"; within:512; metadata:ruleset community; reference:bugtraq,9407; reference:cve,2003-0903; reference:nessus,11990; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-003; classtype:attempted-user; sid:2329; rev:14;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-MSSQL Microsoft SQL Server Reporting Services cross site scripting attempt"; flow:established,to_server; content:"/Reports/Pages/Report.aspx"; fast_pattern:only; http_uri; content:"SelectedSubTabId="; nocase; http_uri; pcre:"/[?&]SelectedSubTabId=[^&]*?([\x22\x27\x3c\x3e\x28\x29]|onload|src)/iU"; metadata:service http; reference:cve,2012-2552; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-070; classtype:web-application-attack; sid:24355; rev:4;)
 alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SERVER-MSSQL Microsoft SQL Server Reporting Services cross site scripting attempt"; flow:established,to_client; file_data; content:"href=|22|/Reports/Pages/Report.aspx?"; nocase; content:"SelectedSubTabId="; distance:0; nocase; content:"script"; within:50; nocase; pcre:"/SelectedSubTabId=[^>]*?([\x22\x27]|%22|%27)\s*?>\s*?<[^>]*?script/i"; metadata:service http; reference:cve,2012-2552; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-070; classtype:attempted-user; sid:24356; rev:4;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL Microsoft SQL Server TDS packet fragment handling remote denial of service attempt"; flow:to_server,established; content:"|10 00 00 08 41 41 41 41|"; fast_pattern:only; metadata:service dcerpc; reference:bugtraq,11265; reference:cve,2004-1560; reference:url,osvdb.org/show/osvdb/10379; classtype:attempted-dos; sid:29028; rev:1;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL Microsoft SQL Server TDS packet fragment handling remote denial of service attempt"; flow:to_server,established; content:"|10 00 00 10 CC CC CC CC CC CC CC CC CC CC CC CC|"; fast_pattern:only; metadata:service dcerpc; reference:bugtraq,11265; reference:cve,2004-1560; reference:url,osvdb.org/show/osvdb/10379; classtype:attempted-dos; sid:29029; rev:1;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1024:5000 (msg:"SERVER-MSSQL Microsoft SQL Server transcational replication and showxmlplan enabled remote code execution attempt"; flow:to_server; content:"sp_replicationdboption"; fast_pattern:only; content:"SET SHOWPLAN_XML ON"; nocase; content:"@optname"; nocase; content:"publish"; within:20; nocase; content:"@value"; within:20; nocase; content:"true"; within:20; nocase; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2015-1762; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-058; classtype:attempted-user; sid:35198; rev:4;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL Microsoft SQL Server sp_addsrvrolemember privilege escalation attempt"; flow:to_server,established; content:"s|00|p|00|_|00|a|00|d|00|d|00|s|00|r|00|v|00|r|00|o|00|l|00|e|00|m|00|e|00|m|00|b|00|e|00|r"; fast_pattern:only; content:"|27 00|s|00|y|00|s|00|a|00|d|00|m|00|i|00|n|00 27|"; reference:url,msdn.microsoft.com/en-us/library/ms186320.aspx; classtype:attempted-admin; sid:39449; rev:1;)
 alert udp $EXTERNAL_NET any -> $HOME_NET 1434 (msg:"SERVER-MSSQL heap-based overflow attempt"; flow:to_server; content:"|08|"; depth:1; isdataat:50; content:"|3A|"; pcre:"/[0-9]+/R"; reference:bugtraq,5310; reference:cve,2002-0649; reference:nessus,11214; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-039; classtype:attempted-admin; sid:4989; rev:8;)
 alert udp $EXTERNAL_NET any -> $HOME_NET 1434 (msg:"SERVER-MSSQL heap-based overflow attempt"; flow:to_server; content:"|04|"; depth:1; isdataat:50,relative; content:!"|3A|"; within:50; reference:bugtraq,5310; reference:cve,2002-0649; reference:nessus,11214; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-039; classtype:attempted-admin; sid:4990; rev:12;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_reg* - registry access"; flow:to_server,established; content:"x|00|p|00|_|00|r|00|e|00|g|00|"; fast_pattern:only; metadata:ruleset community; reference:bugtraq,5205; reference:cve,2002-0642; reference:nessus,10642; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-034; classtype:attempted-user; sid:686; rev:17;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_reg* registry access"; flow:to_server,established; content:"x|00|p|00|_|00|r|00|e|00|g|00|"; depth:32; offset:32; nocase; metadata:ruleset community; reference:bugtraq,5205; reference:cve,2002-0642; reference:nessus,10642; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-034; classtype:attempted-user; sid:689; rev:16;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_sprintf possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|"; offset:32; nocase; metadata:ruleset community; reference:bugtraq,1204; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-060; classtype:attempted-user; sid:695; rev:14;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_sprintf possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|"; fast_pattern:only; metadata:ruleset community; reference:bugtraq,1204; reference:bugtraq,3733; reference:cve,2001-0542; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-060; classtype:attempted-user; sid:704; rev:16;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL sp_oacreate unicode vulnerable function attempt"; flow:to_server,established; content:"s|00|p|00|_|00|o|00|a|00|c|00|r|00|e|00|a|00|t|00|e|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8496; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL sp_oacreate vulnerable function attempt"; flow:to_server,established; content:"sp_oacreate"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8497; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL sp_oacreate unicode vulnerable function attempt"; flow:to_server,established; content:"s|00|p|00|_|00|o|00|a|00|c|00|r|00|e|00|a|00|t|00|e|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8498; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_displayparamstmt unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|d|00|i|00|s|00|p|00|l|00|a|00|y|00|p|00|a|00|r|00|a|00|m|00|s|00|t|00|m|00|t|00|"; fast_pattern:only; reference:bugtraq,2030; reference:cve,2000-1081; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8499; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_displayparamstmt unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|d|00|i|00|s|00|p|00|l|00|a|00|y|00|p|00|a|00|r|00|a|00|m|00|s|00|t|00|m|00|t|00|"; fast_pattern:only; reference:bugtraq,2030; reference:cve,2000-1081; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8500; rev:8;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_displayparamstmt vulnerable function attempt"; flow:to_server,established; content:"xp_displayparamstmt"; fast_pattern:only; reference:bugtraq,2030; reference:cve,2000-1081; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8501; rev:8;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_enumresultset unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|e|00|n|00|u|00|m|00|r|00|e|00|s|00|u|00|l|00|t|00|s|00|e|00|t|00|"; fast_pattern:only; reference:bugtraq,2031; reference:cve,2000-1082; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8502; rev:8;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_enumresultset unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|e|00|n|00|u|00|m|00|r|00|e|00|s|00|u|00|l|00|t|00|s|00|e|00|t|00|"; fast_pattern:only; reference:bugtraq,2031; reference:cve,2000-1082; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8503; rev:8;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_enumresultset vulnerable function attempt"; flow:to_server,established; content:"xp_enumresultset"; fast_pattern:only; reference:bugtraq,2031; reference:cve,2000-1082; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8504; rev:8;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oadestroy unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|d|00|e|00|s|00|t|00|r|00|o|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8505; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_oadestroy unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|d|00|e|00|s|00|t|00|r|00|o|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8506; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oadestroy vulnerable function attempt"; flow:to_server,established; content:"xp_oadestroy"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8507; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oagetproperty unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|g|00|e|00|t|00|p|00|r|00|o|00|p|00|e|00|r|00|t|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8508; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_oagetproperty unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|g|00|e|00|t|00|p|00|r|00|o|00|p|00|e|00|r|00|t|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8509; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oagetproperty vulnerable function attempt"; flow:to_server,established; content:"xp_oagetproperty"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8510; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oamethod unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|m|00|e|00|t|00|h|00|o|00|d|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8511; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oamethod vulnerable function attempt"; flow:to_server,established; content:"xp_oamethod"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8512; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_oamethod unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|m|00|e|00|t|00|h|00|o|00|d|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8513; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oasetproperty unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|s|00|e|00|t|00|p|00|r|00|o|00|p|00|e|00|r|00|t|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8514; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_oasetproperty unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|o|00|a|00|s|00|e|00|t|00|p|00|r|00|o|00|p|00|e|00|r|00|t|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8515; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_oasetproperty vulnerable function attempt"; flow:to_server,established; content:"xp_oasetproperty"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8516; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_peekqueue unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|e|00|e|00|k|00|q|00|u|00|e|00|u|00|e|00|"; fast_pattern:only; reference:bugtraq,2041; reference:cve,2000-1085; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8517; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_peekqueue unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|e|00|e|00|k|00|q|00|u|00|e|00|u|00|e|00|"; fast_pattern:only; reference:bugtraq,2041; reference:cve,2000-1085; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8518; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_peekqueue vulnerable function attempt"; flow:to_server,established; content:"xp_peekqueue"; fast_pattern:only; reference:bugtraq,2041; reference:cve,2000-1085; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8519; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_printstatements unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|i|00|n|00|t|00|s|00|t|00|a|00|t|00|e|00|m|00|e|00|n|00|t|00|s|00|"; fast_pattern:only; reference:bugtraq,2041; reference:cve,2000-1086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8520; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_printstatements unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|i|00|n|00|t|00|s|00|t|00|a|00|t|00|e|00|m|00|e|00|n|00|t|00|s|00|"; fast_pattern:only; reference:bugtraq,2041; reference:cve,2000-1086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8521; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_printstatements vulnerable function attempt"; flow:to_server,established; content:"xp_printstatements"; fast_pattern:only; reference:bugtraq,2041; reference:cve,2000-1086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8522; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_proxiedmetadata unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|o|00|x|00|i|00|e|00|d|00|m|00|e|00|t|00|a|00|d|00|a|00|t|00|a|00|"; fast_pattern:only; reference:bugtraq,2024; reference:cve,1999-0287; reference:cve,2000-1087; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8523; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_proxiedmetadata unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|o|00|x|00|i|00|e|00|d|00|m|00|e|00|t|00|a|00|d|00|a|00|t|00|a|00|"; fast_pattern:only; reference:bugtraq,2024; reference:cve,1999-0287; reference:cve,2000-1087; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8524; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_proxiedmetadata vulnerable function attempt"; flow:to_server,established; content:"xp_proxiedmetadata"; fast_pattern:only; reference:bugtraq,2024; reference:cve,1999-0287; reference:cve,2000-1087; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8525; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_SetSQLSecurity unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|S|00|e|00|t|00|S|00|Q|00|L|00|S|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|"; fast_pattern:only; reference:bugtraq,2043; reference:cve,2000-1086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8526; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_SetSQLSecurity unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|S|00|e|00|t|00|S|00|Q|00|L|00|S|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|"; fast_pattern:only; reference:bugtraq,2043; reference:cve,2000-1086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8527; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_SetSQLSecurity vulnerable function attempt"; flow:to_server,established; content:"xp_SetSQLSecurity"; fast_pattern:only; reference:bugtraq,2043; reference:cve,2000-1086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8528; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_showcolv unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|h|00|o|00|w|00|c|00|o|00|l|00|v|00|"; fast_pattern:only; reference:bugtraq,2038; reference:cve,2000-1083; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8529; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_showcolv unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|h|00|o|00|w|00|c|00|o|00|l|00|v|00|"; fast_pattern:only; reference:bugtraq,2038; reference:cve,2000-1083; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8530; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_showcolv vulnerable function attempt"; flow:to_server,established; content:"xp_showcolv"; fast_pattern:only; reference:bugtraq,2038; reference:cve,2000-1083; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8531; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_sqlagent_monitor unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|q|00|l|00|a|00|g|00|e|00|n|00|t|00|_|00|m|00|o|00|n|00|i|00|t|00|o|00|r|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8532; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_sqlagent_monitor vulnerable function attempt"; flow:to_server,established; content:"xp_sqlagent_monitor"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8533; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_sqlagent_monitor unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|q|00|l|00|a|00|g|00|e|00|n|00|t|00|_|00|m|00|o|00|n|00|i|00|t|00|o|00|r|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8534; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_sqlinventory unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|q|00|l|00|i|00|n|00|v|00|e|00|n|00|t|00|o|00|r|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8535; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_sqlinventory vulnerable function attempt"; flow:to_server,established; content:"xp_sqlinventory"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8536; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_sqlinventory unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|q|00|l|00|i|00|n|00|v|00|e|00|n|00|t|00|o|00|r|00|y|00|"; fast_pattern:only; reference:url,support.microsoft.com/kb/280380; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8537; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_updatecolvbm unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|u|00|p|00|d|00|a|00|t|00|e|00|c|00|o|00|l|00|v|00|b|00|m|00|"; fast_pattern:only; reference:bugtraq,2039; reference:cve,2000-1084; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8538; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"SERVER-MSSQL xp_updatecolvbm unicode vulnerable function attempt"; flow:to_server,established; content:"x|00|p|00|_|00|u|00|p|00|d|00|a|00|t|00|e|00|c|00|o|00|l|00|v|00|b|00|m|00|"; fast_pattern:only; reference:bugtraq,2039; reference:cve,2000-1084; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8539; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SERVER-MSSQL xp_updatecolvbm vulnerable function attempt"; flow:to_server,established; content:"xp_updatecolvbm"; fast_pattern:only; reference:bugtraq,2039; reference:cve,2000-1084; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-092; classtype:attempted-admin; sid:8540; rev:8;)


 ----- Begin VRT-server-mysql Rules Category ----- 

 -- Begin GID:1 Based Rules -- 

 alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"SERVER-MYSQL failed Oracle Mysql login attempt"; flow:established,to_client; content:"|15 04|"; depth:2; offset:5; metadata:service mysql; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13357; rev:7;)
 alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"SERVER-MYSQL Oracle Mysql login attempt from unauthorized location"; flow:established,to_client; content:"j|04|"; depth:2; offset:5; metadata:service mysql; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13358; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL yaSSL SSLv3 Client Hello Message Cipher Specs Buffer Overflow attempt"; flow:to_server,established; content:"|16 03 01|"; content:"|01|"; within:1; distance:2; content:"|03 01|"; within:2; distance:3; byte_jump:1,32,relative; byte_test:2,>,64,0,relative; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,27140; reference:cve,2008-0226; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-user; sid:13714; rev:16;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL XML Functions ExtractValue Scalar XPath denial of service attempt"; flow:to_server,established; content:"|03|"; depth:1; offset:4; content:"SELECT"; distance:0; nocase; content:"ExtractValue"; distance:1; nocase; pcre:"/^.{4}\x03\s*SELECT\s+ExtractValue\s*\x28.*?\x2c\s*((\x22|\x27)?[0-9].*?|(?P<q1>(\x22|\x27)?)\x28.*?\x29(?P=q1)|.*?\x24\x40.*?|\x22.*?\x27.*?|\x27.*?\x22.*?)\s*\x29/siO"; metadata:service mysql; reference:bugtraq,33972; reference:cve,2009-0819; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-32.html; reference:url,secunia.com/advisories/34115; classtype:attempted-dos; sid:15442; rev:6;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL XML Functions UpdateXML Scalar XPath denial of service attempt"; flow:to_server,established; content:"|03|"; depth:1; offset:4; content:"SELECT"; distance:0; nocase; content:"UpdateXML"; distance:1; nocase; pcre:"/^.{4}\x03\s*SELECT\s+UpdateXML\s*\x28.*?\x2c\s*((\x22|\x27)?[0-9].*?|(?P<q1>(\x22|\x27)?)\x28.*?\x29(?P=q1)|.*?\x24\x40.*?|\x22.*?\x27.*?|\x27.*?\x22.*?)\s*\x2c.*?\x29/siO"; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,33972; reference:cve,2009-0819; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-32.html; reference:url,secunia.com/advisories/34115; classtype:attempted-dos; sid:15443; rev:10;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 (msg:"SERVER-MYSQL MaxDB Webtool GET command overflow attempt"; flow:to_server,established; content:"GET /%AAAAAAAA"; depth:14; metadata:policy max-detect-ips drop, service http; reference:bugtraq,13368; reference:cve,2005-0684; classtype:attempted-user; sid:15951; rev:11;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL create function libc arbitrary code execution attempt"; flow:to_server,established; content:"|03|create function"; depth:16; offset:4; content:"libc.so"; distance:0; metadata:service mysql; reference:bugtraq,12781; reference:cve,2005-0709; classtype:attempted-user; sid:15952; rev:5;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL login handshake information disclosure attempt"; flow:to_server,established; content:"|01 0D A6 03 00 00 00 00 01 08|"; fast_pattern:only; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,17780; reference:cve,2006-1516; classtype:misc-activity; sid:16020; rev:13;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL database PROCEDURE ANALYSE denial of service attempt - 1"; flow:to_server,established; content:"'|00 00 00 03|select * from `v1` procedure analyse|28 29|"; depth:43; metadata:service mysql; reference:cve,2009-4019; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-41.html; classtype:attempted-dos; sid:16348; rev:6;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL database Procedure Analyse denial of service attempt - 2"; flow:to_server,established; content:",|00 00 00 03|select * from `theview` procedure analyse|28 29|"; depth:48; metadata:service mysql; reference:cve,2009-4019; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-41.html; classtype:attempted-dos; sid:16349; rev:6;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL yaSSL library cert parsing stack overflow attempt"; flow:to_server,established; content:"|16 03 01|"; depth:3; content:"|0B|"; within:1; distance:2; content:"*|86 00 84 00 00 04|"; within:8; distance:56; metadata:service mysql; reference:bugtraq,37640; reference:cve,2009-4484; classtype:attempted-user; sid:16385; rev:6;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Database COM_FIELD_LIST Buffer Overflow attempt"; flow:to_server,established; content:"|04|"; depth:1; offset:4; pcre:"/^[^\x0D\x0A\x00]{512}/iR"; metadata:policy max-detect-ips drop, service mysql; reference:cve,2010-1850; classtype:attempted-user; sid:16703; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL mysql_log COM_CREATE_DB format string vulnerability exploit attempt"; flow:to_server,established; content:"|05|"; depth:1; offset:4; content:"|25|"; distance:0; byte_jump:3,0,little; isdataat:0,relative; isdataat:!1,relative; metadata:service mysql; reference:bugtraq,35609; reference:cve,2009-2446; classtype:attempted-user; sid:16707; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL mysql_log COM_DROP_DB format string vulnerability exploit attempt"; flow:to_server,established; content:"|06|"; depth:1; offset:4; content:"|25|"; distance:0; byte_jump:3,0,little; isdataat:0,relative; isdataat:!1,relative; metadata:service mysql; reference:bugtraq,35609; reference:cve,2009-2446; classtype:attempted-user; sid:16708; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL create function mysql.func arbitrary library injection attempt"; flow:to_server,established; content:"|03|"; depth:5; content:"mysql.func"; distance:0; nocase; pcre:"/(INSERT|UPDATE)\s*[\s\w]*((mysql\.)?func)[^\r\n]+values\s*\([^\)]+\x2c[\x22\x27][^\x22\x27]*\x2f/i"; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,12781; reference:cve,2005-0710; classtype:attempted-user; sid:17412; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL root login attempt"; flow:to_server,established; content:"|0A 00 00 01 85 04 00 00 80|root|00|"; fast_pattern:only; metadata:ruleset community, service mysql; classtype:protocol-command-decode; sid:1775; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL show databases attempt"; flow:to_server,established; content:"|0F 00 00 00 03|show databases"; fast_pattern:only; metadata:ruleset community, service mysql; classtype:protocol-command-decode; sid:1776; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL yaSSL SSL Hello Message Buffer Overflow attempt"; flow:to_server,established; content:"|20 00 00 01|"; depth:4; content:"|8D|"; within:2; content:"|00 00 00 00 00 40 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 03 01 00 00 00 00 0F FF|"; within:42; metadata:policy max-detect-ips drop, service mysql; reference:cve,2008-0226; reference:url,aluigi.altervista.org/adv/yasslick-adv.txt; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-admin; sid:18513; rev:13;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Database CASE NULL argument denial of service attempt"; flow:to_server,established; content:"|03|select|20 28|case|20 28 60|a|60 29 20|when"; depth:30; content:"group|20|by|20 60|a|60 0A|with|20|rollup"; within:100; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,42596; reference:cve,2010-3678; classtype:attempted-dos; sid:19000; rev:9;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL IN NULL argument denial of service attempt"; flow:to_server,established; content:"|03|"; depth:1; offset:4; content:"SELECT"; distance:0; nocase; content:"IN"; distance:0; nocase; content:"NULL"; within:10; fast_pattern; nocase; pcre:"/IN\s*\x28\s*NULL\s*\x2C\s*[0-9a-z\x24\x5F\x60]/i"; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,42596; reference:cve,2010-3678; classtype:attempted-dos; sid:19001; rev:8;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Database unique set column denial of service attempt"; flow:to_server,established; content:"select 1 from |60|t2|60| join |60|t1|60| on 1 like |60|a|60|"; fast_pattern:only; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,42646; reference:cve,2010-3677; classtype:attempted-dos; sid:19093; rev:12;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Database unique set column denial of service attempt"; flow:to_server,established; content:"select |2A| from A join B on |27|val|27| like colA"; fast_pattern:only; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,42646; reference:cve,2010-3677; classtype:attempted-dos; sid:19094; rev:12;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Database SELECT subquery denial of service attempt"; flow:to_server,established; content:"|65 6C 65 63 74 20 2A 20 66 72 6F 6D 20 62 6F 6F 6D 29 20 69|"; fast_pattern:only; metadata:service mysql; reference:cve,2009-4019; reference:url,bugs.mysql.com/bug.php?id=48291; classtype:attempted-dos; sid:20053; rev:6;)
 alert tcp any any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB client authentication bypass attempt"; flow:to_server,established; content:"|00 00 01|"; depth:3; offset:1; fast_pattern; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:23; distance:9; pcre:"/^\w+\x00/iRm"; detection_filter:track by_src,count 100, seconds 5; metadata:service mysql; reference:cve,2012-2122; classtype:attempted-admin; sid:23115; rev:5;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Oracle MySQL grant file long database name stack overflow attempt"; flow:to_server,established; content:"grant "; nocase; isdataat:193,relative; pcre:"/grant\s.+?\son\s[^\.\s]{193}/mi"; metadata:service mysql; reference:bugtraq,56769; reference:cve,2012-5611; classtype:attempted-user; sid:24897; rev:4;)
 alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"SERVER-MYSQL Oracle MySQL user enumeration attempt"; flow:to_client,established; content:"|15 04|"; depth:2; offset:5; content:"Access denied for user"; fast_pattern:only; detection_filter:track by_dst,count 10, seconds 2; metadata:service mysql; reference:bugtraq,56766; reference:cve,2012-5615; classtype:attempted-recon; sid:24908; rev:5;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Oracle MySQL select UpdateXML nested xml elements denial of service attempt"; flow:to_server,established; content:"SELECT "; nocase; content:"UpdateXML|28|"; within:50; nocase; isdataat:1024; content:!"|29|"; within:1024; pcre:"/^\s*[\x22\x27]<\w>\s*<\s*[a-z][0-9]\s*>\s*<\s*[a-z][0-9]\s*>\s*<\s*[a-z][0-9]\s*>/Ri"; metadata:service mysql; reference:cve,2012-5614; classtype:attempted-dos; sid:24909; rev:2;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Oracle MySQL MDL free corrupted pointer heap overflow attempt"; flow:to_server,established; content:"ZZZZZZZZZZZROM t WHERE 1=1"; fast_pattern:9,16; content:"ZZZZZZZZZZZZZZZZZZZZ"; within:100; metadata:service mysql; reference:bugtraq,56768; reference:cve,2012-5612; classtype:attempted-user; sid:24910; rev:2;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query polygon object integer overflow attempt"; flow:to_server,established; content:"geometryn("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0700000001000000"; within:16; distance:10; content:"0300000002000000"; within:16; distance:2; byte_test:8,>=,65535,8,relative,little,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26299; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multistring object integer overflow attempt"; flow:to_server,established; content:"geometryn("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0700000001000000"; within:16; distance:10; content:"0500000001000000"; within:16; distance:2; byte_test:8,>=,65535,10,relative,little,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26300; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multipolygon object integer overflow attempt"; flow:to_server,established; content:"geometryn("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0700000001000000"; within:16; distance:10; content:"0600000001000000"; within:16; distance:2; content:"01000000"; within:8; distance:10; byte_test:8,>=,65535,0,relative,little,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26301; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query linestring object integer overflow attempt"; flow:to_server,established; content:"astext("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"02000000"; within:8; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26302; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query polygon object integer overflow attempt"; flow:to_server,established; content:"astext("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0300000001000000"; within:16; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26303; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multistring object integer overflow attempt"; flow:to_server,established; content:"astext("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0500000001000000"; within:16; distance:10; byte_test:2,>=,0x10,16,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26304; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multipolygon object integer overflow attempt"; flow:to_server,established; content:"astext("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0600000001000000"; within:16; distance:10; content:"01000000"; within:8; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26305; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query linestring object integer overflow attempt"; flow:to_server,established; content:"st_area("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"02000000"; within:8; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26306; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query polygon object integer overflow attempt"; flow:to_server,established; content:"st_area("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0300000001000000"; within:16; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26307; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multistring object integer overflow attempt"; flow:to_server,established; content:"st_area("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0500000001000000"; within:16; distance:10; byte_test:2,>=,0x10,16,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26308; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multipolygon object integer overflow attempt"; flow:to_server,established; content:"st_area("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0600000001000000"; within:16; distance:10; content:"01000000"; within:8; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26309; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query linestring object integer overflow attempt"; flow:to_server,established; content:"envelope("; fast_pattern; nocase; content:"0x"; distance:0; byte_test:2,>=,0x10,18,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26310; rev:4;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query polygon object integer overflow attempt"; flow:to_server,established; content:"envelope("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0300000001000000"; within:16; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26311; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multistring object integer overflow attempt"; flow:to_server,established; content:"envelope("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0500000001000000"; within:16; distance:10; byte_test:2,>=,0x10,16,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26312; rev:3;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query multipolygon object integer overflow attempt"; flow:to_server,established; content:"envelope("; fast_pattern; nocase; content:"0x"; distance:0; nocase; content:"0600000001000000"; within:16; distance:10; content:"01000000"; within:8; distance:10; byte_test:2,>=,0x10,6,relative,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:26313; rev:3;)
 alert tcp $EXTERNAL_NET 3306 -> $HOME_NET any (msg:"SERVER-MYSQL MySQL/MariaDB mysql.cc buffer overflow attempt"; flow:to_client,established; content:"|01 00 00 01 01 27 00 00 02|"; depth:9; content:"@@version_comment"; fast_pattern; isdataat:460,relative; metadata:service mysql; reference:bugtraq,65298; reference:cve,2014-0001; reference:url,osvdb.org/show/osvdb/102714; classtype:attempted-user; sid:31570; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:"SERVER-MYSQL Oracle MySQL Server XPath memory Corruption attempt"; flow:to_server,established; content:"substring("; nocase; content:",.."; within:7; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop; reference:cve,2014-0384; classtype:denial-of-service; sid:32533; rev:1;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET 11211 (msg:"SERVER-MYSQL Oracle MySQL Server InnoDB Memcached plugin resource exhaustion attempt"; flow:to_server, established; content:"bind"; detection_filter:track by_src, count 50, seconds 5; metadata:impact_flag red; reference:cve,2013-1570; classtype:denial-of-service; sid:32647; rev:1;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET 11211 (msg:"SERVER-MYSQL Oracle MySQL Server InnoDB Memcached plugin resource exhaustion attempt"; flow:to_server, established; content:"|80|"; depth:1; content:"@@"; distance:2; detection_filter:track by_src, count 50, seconds 5; metadata:impact_flag red; reference:cve,2013-1570; classtype:denial-of-service; sid:32648; rev:1;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET 11211 (msg:"SERVER-MYSQL Oracle MySQL Server InnoDB Memcached plugin resource exhaustion attempt"; flow:to_server, established; content:"@@"; fast_pattern:only; content:"get"; depth:3; detection_filter:track by_src, count 50, seconds 5; metadata:impact_flag red; reference:cve,2013-1570; classtype:denial-of-service; sid:32649; rev:1;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET 11211 (msg:"SERVER-MYSQL Oracle MySQL Server InnoDB Memcached plugin resource exhaustion attempt"; flow:to_server, established; content:"@@"; fast_pattern:only; content:"set"; depth:3; detection_filter:track by_src, count 50, seconds 5; metadata:impact_flag red; reference:cve,2013-1570; classtype:denial-of-service; sid:32650; rev:1;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET 11211 (msg:"SERVER-MYSQL Oracle MySQL Server InnoDB Memcached plugin resource exhaustion attempt"; flow:to_server, established; content:"@@"; fast_pattern:only; content:"add"; depth:3; detection_filter:track by_src, count 50, seconds 5; metadata:impact_flag red; reference:cve,2013-1570; classtype:denial-of-service; sid:32651; rev:1;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL MySQL/MariaDB Server geometry query object integer overflow attempt"; flow:to_server,established; content:"geometryn("; fast_pattern; nocase; content:"0x"; distance:0; byte_test:8,>=,65535,54,relative,little,string,hex; metadata:service mysql; reference:cve,2013-1861; reference:url,osvdb.org/show/osvdb/91415; classtype:attempted-admin; sid:33637; rev:1;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL 4.0 root login attempt"; flow:to_server,established; content:"|01|"; depth:1; offset:3; content:"root|00|"; within:5; distance:5; nocase; metadata:ruleset community, service mysql; classtype:protocol-command-decode; sid:3456; rev:9;)
 alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-MYSQL MaxDB WebSQL wppassword buffer overflow"; flow:to_server,established; content:"websql?logon"; nocase; content:"wqPassword="; distance:0; nocase; pcre:"/wqPassword=[^\r\n\x26]{294}/i"; metadata:service http; reference:bugtraq,12265; reference:cve,2005-0111; reference:url,osvdb.org/show/osvdb/12919; classtype:web-application-attack; sid:3518; rev:10;)
 alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-MYSQL MaxDB WebSQL wppassword buffer overflow default port"; flow:to_server,established; content:"websql?logon"; nocase; content:"wqPassword="; distance:0; nocase; pcre:"/wqPassword=[^\r\n\x26]{294}/i"; metadata:service http; reference:bugtraq,12265; reference:cve,2005-0111; reference:url,osvdb.org/show/osvdb/12919; classtype:web-application-attack; sid:3519; rev:11;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL create function access attempt"; flow:to_server,established; content:"|03|create"; offset:4; nocase; pcre:"/\x03create\s+(aggregate\s+)*function/smi"; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,12781; reference:cve,2005-0709; classtype:misc-activity; sid:3528; rev:12;)
 alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"SERVER-MYSQL server greeting"; flow:to_client,established; content:"|00|"; depth:1; offset:3; flowbits:set,mysql.server_greeting; flowbits:noalert; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:attempted-user; sid:3665; rev:10;)
 alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"SERVER-MYSQL server greeting finished"; flow:to_client,established; byte_test:1,>,0,3; flowbits:isset,mysql.server_greeting; flowbits:unset,mysql.server_greeting; flowbits:noalert; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:attempted-user; sid:3666; rev:12;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL protocol 41 client authentication bypass attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,&,0x02,4; content:"|00 14 00|"; offset:36; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3667; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL client authentication bypass attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,!&,0x02,4; content:"|00 14 00|"; offset:9; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3668; rev:12;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL protocol 41 secure client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,&,0x02,4; content:"|00 14|"; offset:36; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3669; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL secure client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,!&,0x02,4; content:"|00 14|"; offset:9; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3670; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL protocol 41 client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,!&,0x80,4; byte_test:1,&,0x02,4; content:"|00|"; offset:36; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3671; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,!&,0x80,4; byte_test:1,!&,0x02,4; content:"|00|"; offset:9; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3672; rev:10;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Multiple SQL products privilege escalation attempt"; flow:to_server,established; content:"select "; nocase; content:"malloc_lib="; within:100; nocase; content:".so"; within:50; nocase; pcre:"/select [\x22\x27][^\x22\x27]{0,100}malloc_lib=\S+\.so[\x22\x27]/si"; metadata:policy security-ips drop, service http; reference:cve,2016-6662; classtype:attempted-admin; sid:40253; rev:1;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Multiple SQL products privilege escalation attempt"; flow:to_server,established; content:"set "; content:"global "; within:15; content:"general_log_file"; within:35; content:"/my.cnf"; within:100; pcre:"/set\s+global\s+general_log_file\s+=\s+[\x22\x27][^\x22\x27]{0,100}my\.cnf[\x22\x27]/si"; metadata:policy security-ips drop, service http; reference:cve,2016-6662; classtype:attempted-admin; sid:40254; rev:1;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL create function buffer overflow attempt"; flow:to_server,established; content:"|03|create"; offset:4; nocase; pcre:"/\x03create\s+(aggregate\s+)*function\s+\S{50}/smi"; metadata:service mysql; reference:bugtraq,14509; reference:cve,2005-2558; classtype:misc-activity; sid:4649; rev:7;)
 alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"SERVER-MYSQL Date_Format denial of service attempt"; flow:to_server,established; content:"DATE_FORMAT"; nocase; pcre:"/DATE_FORMAT\x28\s*(\x22[^\x22]+\x25[^\x22]*\x22|\x27[^\x27]+\x25[^\x27]*\x27)/smi"; metadata:policy max-detect-ips drop, service mysql; reference:bugtraq,19032; reference:cve,2006-3469; reference:url,dev.mysql.com/doc/refman/5.0/en/news-5-0-21.html; classtype:attempted-dos; sid:8057; rev:11;)
